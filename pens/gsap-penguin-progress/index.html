<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GSAP Penguin Progress</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.3.3/gsap.min.js"></script>
</head>
<body>
    <label for="fav-animal-input">What is your favourite animal and why is it penguins? 
    </label>
    <br/>
    <div class="penguin-container">
        <div class="word-count"></div>
        <div class="penguin">
            <div class="penguin__tail"></div>
            <div class="penguin__feet"></div>
            <div class="penguin__body"></div>
            <div class="penguin__head"></div>
            <div class="penguin__wings">
                <div class="penguin__wing--left"></div>
                <div class="penguin__wing--right"></div>
            </div>
        </div>
    </div>
    <textarea id="fav-animal-input" class="textbox" maxLength="10"></textarea>

<script>
    

    function setWordCountLabel(text) {
        document.querySelector('.word-count').innerHTML = text;
    }
    
    const textboxMaxLength = document.querySelector('.textbox').maxLength;
    setWordCountLabel(`Tell us in ${textboxMaxLength} words or less`);

    const textboxWidth = document.querySelector('.textbox').getBoundingClientRect()['width'];
    const penguinWidth = document.querySelector('.penguin').getBoundingClientRect()['width'];
    const penguinMaxOffsetX = textboxWidth - penguinWidth;

    const penguinAnimDur = 0.2;

    document.querySelector('.textbox').addEventListener('keyup', e => {
        const wordCount = e.target.value.length;
        setWordCountLabel(`${wordCount} / ${textboxMaxLength}`);


        const anim = gsap.timeline({
            defaults: {
                duration: penguinAnimDur
            }
        });


        const penguinOffsetX = wordCount / textboxMaxLength * penguinMaxOffsetX;

        anim.to('.penguin', {
            x: penguinOffsetX,
        }).to('.word-count', {
            x: penguinOffsetX,
        }, `-=${penguinAnimDur}`);

        switch(wordCount) {
            case 0:
            case textboxMaxLength:
                setWordCountLabel(wordCount === 0 ? `Tell us in ${textboxMaxLength} words or less`: `Reached word limit!`);
                anim
                .to('.penguin__body', {
                    borderRadius: '50px 50px 35px 35px',
                    width: 35,
                    height: 37,
                    y: 10,
                    boxShadow: 'inset 0px 6px 0px 5px black',
                })
                .to('.penguin__head', {
                    x: 13,
                    y: 0,
                    rotate: 0
                }, `-=${penguinAnimDur}`)
                .to('.penguin__wing--right', {
                    x: 29,
                    y: 23,
                }, `-=${penguinAnimDur}`)
                .to('.penguin__wing--left', {
                    x: -6,
                    y: 23,
                    rotate: -48
                }, `-=${penguinAnimDur}`)
                .to('.penguin__feet', {
                    x: 10,
                    y: 40,
                    rotate: 0,
                    boxShadow: '15px 0 #f5b23a'
                }, `-=${penguinAnimDur}`)
                .to('.penguin__tail', {
                    x: 3,
                    y: 33,
                    rotate: 27,
                }, `-=${penguinAnimDur}`);
                break;
            default:
                anim.to('.penguin__body', {
                    borderRadius: '50px 50px 20px 20px',
                    width: 38,
                    height: 26,
                    y: 24,
                    boxShadow: 'inset 0px 11px 0px 5px black',
                })
                .to('.penguin__head', {
                    x: 28,
                    y: 20,
                    rotate: 30,
                }, `-=${penguinAnimDur}`)
                .to('.penguin__wing--right', {
                    x: 18,
                    y: 31,
                }, `-=${penguinAnimDur}`)
                .to('.penguin__wing--left', {
                    x: 13,
                    y: 38,
                    rotate: wordCount%2 > 0 ? -48 : -117
                }, `-=${penguinAnimDur}`)
                .to('.penguin__feet', {
                    x: -1,
                    y: 40,
                    rotate: 85,
                    boxShadow: 'none'
                }, `-=${penguinAnimDur}`)
                .to('.penguin__tail', {
                    x: 4,
                    y: 29,
                    rotate: -10,
                }, `-=${penguinAnimDur}`);
                break;
        }
    });

    // todo
        // --------------BASIC--------------
        // - Submit button
        
        // --------------PENGUIN ANIMATION--------------
        // if (wordCount === 0) // starting state
        // if (wordCount === textboxMaxLength) // ending state
</script>
</body>
</html>